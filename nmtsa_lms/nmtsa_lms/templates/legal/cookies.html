{% extends "base.html" %}
{% load static %}

{% block title %}Cookie Policy - NMTSA Learning{% endblock %}

{% block content %}
<div class="min-h-screen bg-background py-12">
  <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Header -->
    <div class="mb-8">
      <h1 class="text-4xl font-bold text-primary mb-4">Cookie Policy</h1>
      <p class="text-muted text-sm">Last Updated: October 12, 2025</p>
    </div>

    <!-- Content -->
    <div class="bg-card rounded-lg border-2 border-default p-6 sm:p-8 space-y-8">
      
      <!-- Introduction -->
      <section>
        <h2 class="text-2xl font-bold text-primary mb-4">1. What Are Cookies?</h2>
        <p class="text-primary-text mb-4">
          Cookies are small text files stored on your device (computer, smartphone, or tablet) when you visit a website. They help websites remember your preferences, login status, and other information to improve your experience.
        </p>
        <p class="text-primary-text">
          NMTSA Learning uses cookies and similar technologies (such as local storage and session storage) to provide, secure, and improve our Learning Management System (LMS) platform.
        </p>
      </section>

      <!-- Types of Cookies -->
      <section>
        <h2 class="text-2xl font-bold text-primary mb-4">2. Types of Cookies We Use</h2>
        
        <!-- Essential Cookies -->
        <div class="mb-6">
          <h3 class="text-xl font-semibold text-primary mb-3">2.1 Essential Cookies (Required)</h3>
          <p class="text-primary-text mb-3">
            These cookies are necessary for the Platform to function and cannot be disabled. They enable core functionality such as:
          </p>
          <ul class="list-disc pl-6 text-primary-text space-y-2 mb-3">
            <li><strong>Authentication:</strong> Session cookies to keep you logged in (via Auth0)</li>
            <li><strong>Security:</strong> CSRF tokens to protect against cross-site request forgery</li>
            <li><strong>Load Balancing:</strong> Routing to the correct server</li>
            <li><strong>Form Data:</strong> Remembering information you entered in forms</li>
          </ul>
          <div class="bg-background border-l-4 border-[color:var(--primary-hover)] p-4 mt-3">
            <p class="text-sm text-primary-text"><strong>Note:</strong> Without these cookies, you cannot log in or access course content.</p>
          </div>
        </div>

        <!-- Functional Cookies -->
        <div class="mb-6">
          <h3 class="text-xl font-semibold text-primary mb-3">2.2 Functional Cookies (Optional)</h3>
          <p class="text-primary-text mb-3">
            These cookies enhance your experience by remembering your preferences:
          </p>
          <ul class="list-disc pl-6 text-primary-text space-y-2 mb-3">
            <li><strong>Theme Preferences:</strong> Light, Dark, High Contrast, or Minimal mode</li>
            <li><strong>Font Size:</strong> Small, Medium, or Large text size</li>
            <li><strong>Language Settings:</strong> Preferred language (if applicable)</li>
            <li><strong>Video Progress:</strong> Resume playback from where you left off</li>
            <li><strong>Chat State:</strong> Whether the chat widget is open or closed</li>
          </ul>
          <p class="text-primary-text text-sm">
            <em>Storage Method:</em> These preferences are stored in your browser's <code>localStorage</code> (e.g., <code>nmtsa-theme</code>, <code>nmtsa-font-size</code>).
          </p>
        </div>

        <!-- Analytics Cookies -->
        <div class="mb-6">
          <h3 class="text-xl font-semibold text-primary mb-3">2.3 Analytics Cookies (Optional)</h3>
          <p class="text-primary-text mb-3">
            These cookies help us understand how users interact with the Platform to improve performance:
          </p>
          <ul class="list-disc pl-6 text-primary-text space-y-2 mb-3">
            <li><strong>Page Views:</strong> Which pages are visited most often</li>
            <li><strong>User Behavior:</strong> Navigation patterns and feature usage</li>
            <li><strong>Error Tracking:</strong> Technical issues and bugs</li>
            <li><strong>Course Analytics:</strong> Completion rates and popular courses</li>
          </ul>
          <p class="text-primary-text text-sm">
            <em>Third-Party Tools:</em> We may use Google Analytics or similar services. These tools collect anonymized data and do not personally identify you.
          </p>
        </div>

        <!-- Third-Party Cookies -->
        <div class="mb-6">
          <h3 class="text-xl font-semibold text-primary mb-3">2.4 Third-Party Cookies</h3>
          <p class="text-primary-text mb-3">
            Some cookies are set by third-party services we use:
          </p>
          <ul class="list-disc pl-6 text-primary-text space-y-2">
            <li><strong>Auth0:</strong> Authentication and single sign-on (SSO) cookies</li>
            <li><strong>PayPal:</strong> Payment processing and fraud prevention</li>
            <li><strong>Supermemory AI:</strong> Chat functionality and personalized recommendations</li>
            <li><strong>Video Hosting:</strong> CDN cookies for video playback (if applicable)</li>
          </ul>
          <p class="text-primary-text mt-3 text-sm">
            These third parties have their own privacy policies. We recommend reviewing them:
          </p>
          <ul class="list-disc pl-6 text-primary-text space-y-1 mt-2 text-sm">
            <li><a href="https://auth0.com/privacy" target="_blank" rel="noopener noreferrer" class="text-[color:var(--primary-hover)] hover:underline">Auth0 Privacy Policy</a></li>
            <li><a href="https://www.paypal.com/us/legalhub/privacy-full" target="_blank" rel="noopener noreferrer" class="text-[color:var(--primary-hover)] hover:underline">PayPal Privacy Policy</a></li>
          </ul>
        </div>
      </section>

      <!-- Cookie Details -->
      <section>
        <h2 class="text-2xl font-bold text-primary mb-4">3. Cookie Details</h2>
        <p class="text-primary-text mb-4">Below is a list of specific cookies used by NMTSA Learning:</p>
        
        <div class="overflow-x-auto">
          <table class="w-full border-2 border-default rounded-lg overflow-hidden">
            <thead class="bg-secondary text-white">
              <tr>
                <th class="px-4 py-3 text-left">Cookie Name</th>
                <th class="px-4 py-3 text-left">Purpose</th>
                <th class="px-4 py-3 text-left">Type</th>
                <th class="px-4 py-3 text-left">Duration</th>
              </tr>
            </thead>
            <tbody class="text-primary-text">
              <tr class="border-b border-default">
                <td class="px-4 py-3"><code>sessionid</code></td>
                <td class="px-4 py-3">User authentication (Django session)</td>
                <td class="px-4 py-3">Essential</td>
                <td class="px-4 py-3">2 weeks</td>
              </tr>
              <tr class="border-b border-default">
                <td class="px-4 py-3"><code>csrftoken</code></td>
                <td class="px-4 py-3">Security (CSRF protection)</td>
                <td class="px-4 py-3">Essential</td>
                <td class="px-4 py-3">1 year</td>
              </tr>
              <tr class="border-b border-default">
                <td class="px-4 py-3"><code>nmtsa-theme</code></td>
                <td class="px-4 py-3">Remember theme preference</td>
                <td class="px-4 py-3">Functional</td>
                <td class="px-4 py-3">Persistent</td>
              </tr>
              <tr class="border-b border-default">
                <td class="px-4 py-3"><code>nmtsa-font-size</code></td>
                <td class="px-4 py-3">Remember font size preference</td>
                <td class="px-4 py-3">Functional</td>
                <td class="px-4 py-3">Persistent</td>
              </tr>
              <tr class="border-b border-default">
                <td class="px-4 py-3"><code>auth0_session</code></td>
                <td class="px-4 py-3">OAuth authentication (Auth0)</td>
                <td class="px-4 py-3">Essential</td>
                <td class="px-4 py-3">Session</td>
              </tr>
              <tr class="border-b border-default">
                <td class="px-4 py-3"><code>_ga</code></td>
                <td class="px-4 py-3">Google Analytics (user tracking)</td>
                <td class="px-4 py-3">Analytics</td>
                <td class="px-4 py-3">2 years</td>
              </tr>
              <tr>
                <td class="px-4 py-3"><code>_gid</code></td>
                <td class="px-4 py-3">Google Analytics (session tracking)</td>
                <td class="px-4 py-3">Analytics</td>
                <td class="px-4 py-3">24 hours</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <!-- How We Use Cookies -->
      <section>
        <h2 class="text-2xl font-bold text-primary mb-4">4. How We Use Cookies</h2>
        <p class="text-primary-text mb-4">We use cookies to:</p>
        <ul class="list-disc pl-6 text-primary-text space-y-2">
          <li><strong>Authenticate Users:</strong> Keep you logged in as you navigate the Platform</li>
          <li><strong>Remember Preferences:</strong> Store theme, font size, and display settings</li>
          <li><strong>Track Progress:</strong> Save your course progress and video positions</li>
          <li><strong>Improve Performance:</strong> Optimize page load times and reduce server load</li>
          <li><strong>Analyze Usage:</strong> Understand which features are most popular</li>
          <li><strong>Prevent Fraud:</strong> Detect suspicious activity and protect your account</li>
          <li><strong>Personalize Content:</strong> Recommend relevant courses based on your interests</li>
        </ul>
      </section>

      <!-- Managing Cookies -->
      <section>
        <h2 class="text-2xl font-bold text-primary mb-4">5. Managing Your Cookie Preferences</h2>
        
        <h3 class="text-xl font-semibold text-primary mb-3">5.1 Browser Settings</h3>
        <p class="text-primary-text mb-4">
          Most browsers allow you to control cookies through their settings. You can:
        </p>
        <ul class="list-disc pl-6 text-primary-text space-y-2 mb-4">
          <li>View and delete existing cookies</li>
          <li>Block all cookies (not recommended)</li>
          <li>Block third-party cookies only</li>
          <li>Clear cookies when you close your browser</li>
          <li>Set cookie preferences per website</li>
        </ul>
        <p class="text-primary-text mb-4">
          Instructions for popular browsers:
        </p>
        <ul class="list-disc pl-6 text-primary-text space-y-1 text-sm">
          <li><a href="https://support.google.com/chrome/answer/95647" target="_blank" rel="noopener noreferrer" class="text-[color:var(--primary-hover)] hover:underline">Google Chrome</a></li>
          <li><a href="https://support.mozilla.org/en-US/kb/enhanced-tracking-protection-firefox-desktop" target="_blank" rel="noopener noreferrer" class="text-[color:var(--primary-hover)] hover:underline">Mozilla Firefox</a></li>
          <li><a href="https://support.apple.com/guide/safari/manage-cookies-sfri11471/mac" target="_blank" rel="noopener noreferrer" class="text-[color:var(--primary-hover)] hover:underline">Safari</a></li>
          <li><a href="https://support.microsoft.com/en-us/microsoft-edge/delete-cookies-in-microsoft-edge-63947406-40ac-c3b8-57b9-2a946a29ae09" target="_blank" rel="noopener noreferrer" class="text-[color:var(--primary-hover)] hover:underline">Microsoft Edge</a></li>
        </ul>

        <h3 class="text-xl font-semibold text-primary mb-3 mt-6">5.2 Impact of Disabling Cookies</h3>
        <div class="bg-background border-l-4 border-secondary p-4">
          <p class="text-primary-text mb-2"><strong>⚠️ Warning:</strong> Disabling cookies may affect Platform functionality:</p>
          <ul class="list-disc pl-6 text-primary-text space-y-1 text-sm">
            <li>You may not be able to log in or stay logged in</li>
            <li>Your preferences (theme, font size) will not be saved</li>
            <li>Video progress will not be tracked</li>
            <li>Some features may not work correctly</li>
          </ul>
        </div>

        <h3 class="text-xl font-semibold text-primary mb-3 mt-6">5.3 Opt-Out of Analytics</h3>
        <p class="text-primary-text mb-3">
          To opt out of Google Analytics tracking, you can:
        </p>
        <ul class="list-disc pl-6 text-primary-text space-y-2">
          <li>Install the <a href="https://tools.google.com/dlpage/gaoptout" target="_blank" rel="noopener noreferrer" class="text-[color:var(--primary-hover)] hover:underline">Google Analytics Opt-out Browser Add-on</a></li>
          <li>Enable "Do Not Track" in your browser settings</li>
          <li>Use privacy-focused browsers like Brave or DuckDuckGo</li>
        </ul>
      </section>

      <!-- Other Tracking Technologies -->
      <section>
        <h2 class="text-2xl font-bold text-primary mb-4">6. Other Tracking Technologies</h2>
        <p class="text-primary-text mb-4">
          In addition to cookies, we use the following technologies:
        </p>
        <ul class="list-disc pl-6 text-primary-text space-y-2">
          <li><strong>Local Storage:</strong> HTML5 local storage for theme preferences and settings (does not expire)</li>
          <li><strong>Session Storage:</strong> Temporary storage for form data (cleared when tab is closed)</li>
          <li><strong>Web Beacons:</strong> Small images in emails to track open rates (if applicable)</li>
          <li><strong>ETags:</strong> HTTP caching headers to improve performance</li>
        </ul>
      </section>

      <!-- Updates to Cookie Policy -->
      <section>
        <h2 class="text-2xl font-bold text-primary mb-4">7. Updates to This Cookie Policy</h2>
        <p class="text-primary-text">
          We may update this Cookie Policy from time to time to reflect changes in our practices or legal requirements. We will post the updated policy on this page with a new "Last Updated" date. We encourage you to review this policy periodically.
        </p>
      </section>

      <!-- Contact Information -->
      <section>
        <h2 class="text-2xl font-bold text-primary mb-4">8. Contact Us</h2>
        <p class="text-primary-text mb-4">
          If you have questions about our use of cookies, please contact us:
        </p>
        <div class="bg-background border-2 border-default rounded-lg p-4 text-primary-text">
          <p><strong>NMTSA Learning</strong></p>
          <p>Email: <a href="mailto:privacy@nmtsalearning.org" class="text-[color:var(--primary-hover)] hover:underline">privacy@nmtsalearning.org</a></p>
          <p>Support: <a href="mailto:support@nmtsalearning.org" class="text-[color:var(--primary-hover)] hover:underline">support@nmtsalearning.org</a></p>
        </div>
      </section>

      <!-- Additional Resources -->
      <section class="bg-background rounded-lg p-4 border-2 border-default">
        <h3 class="text-lg font-semibold text-primary mb-3">📚 Related Policies</h3>
        <div class="flex flex-wrap gap-4">
          <a href="{% url 'privacy_policy' %}" class="text-[color:var(--primary-hover)] hover:underline">Privacy Policy</a>
          <a href="{% url 'terms_of_service' %}" class="text-[color:var(--primary-hover)] hover:underline">Terms of Service</a>
        </div>
      </section>

    </div>

    <!-- Back to Home -->
    <div class="mt-8 text-center">
      <a href="{% url 'landing' %}" class="inline-flex items-center text-[color:var(--primary-hover)] hover:underline">
        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
        </svg>
        Back to Home
      </a>
    </div>
  </div>
</div>
{% endblock %}
