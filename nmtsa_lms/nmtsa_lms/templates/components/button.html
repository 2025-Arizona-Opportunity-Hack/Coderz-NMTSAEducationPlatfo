{# Reusable Button Component with Loading States
   Usage:
   {% include 'components/button.html' with text='Click Me' variant='primary' size='md' href='#' %}

   Parameters:
   - text: Button text (required)
   - variant: primary|secondary|outline|success|danger|warning (default: primary)
   - size: sm|md|lg (default: md)
   - href: Link URL (optional, creates <a> instead of <button>)
   - type: button|submit|reset (default: button, only for <button>)
   - onclick: JavaScript function (optional)
   - disabled: true|false (default: false)
   - loading: true|false - Show loading spinner (default: false)
   - id: Button ID for JavaScript targeting (optional)
   - icon: Icon name to show before text (optional)
#}

{% if href %}
    <a href="{{ href }}"
       {% if id %}id="{{ id }}"{% endif %}
       class="btn btn-{{ variant|default:'primary' }} {% if size == 'sm' %}btn-sm{% elif size == 'lg' %}btn-lg{% endif %}"
       {% if onclick %}onclick="{{ onclick }}"{% endif %}
       {% if disabled %}aria-disabled="true" style="opacity: 0.6; pointer-events: none; cursor: not-allowed;"{% endif %}
       style="display: inline-flex; align-items: center; gap: var(--spacing-sm); justify-content: center; text-decoration: none; position: relative;">

        {% if loading %}
            <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" style="animation: spin 2s linear infinite;" aria-hidden="true">
                <circle cx="12" cy="12" r="10" opacity="0.25"/>
                <path d="M12 2 A10 10 0 0 1 22 12" opacity="1"/>
            </svg>
        {% elif icon %}
            {% include 'components/icon.html' with name=icon size=16 %}
        {% endif %}

        <span>{{ text }}</span>
    </a>
{% else %}
    <button type="{{ type|default:'button' }}"
            {% if id %}id="{{ id }}"{% endif %}
            class="btn btn-{{ variant|default:'primary' }} {% if size == 'sm' %}btn-sm{% elif size == 'lg' %}btn-lg{% endif %}"
            {% if onclick %}onclick="{{ onclick }}"{% endif %}
            {% if disabled or loading %}disabled{% endif %}
            style="display: inline-flex; align-items: center; gap: var(--spacing-sm); justify-content: center; position: relative; {% if disabled or loading %}opacity: 0.6; cursor: not-allowed;{% else %}cursor: pointer;{% endif %}">

        {% if loading %}
            <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" style="animation: spin 2s linear infinite;" aria-hidden="true">
                <circle cx="12" cy="12" r="10" opacity="0.25"/>
                <path d="M12 2 A10 10 0 0 1 22 12" opacity="1"/>
            </svg>
            <span>Processing...</span>
        {% else %}
            {% if icon %}
                {% include 'components/icon.html' with name=icon size=16 %}
            {% endif %}
            <span>{{ text }}</span>
        {% endif %}
    </button>
{% endif %}

<style>
@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* Respect reduced motion preference */
@media (prefers-reduced-motion: reduce) {
    svg {
        animation: none !important;
    }
}

/* Button focus state for accessibility */
.btn:focus {
    outline: 3px solid var(--primary);
    outline-offset: 2px;
}

/* Button hover state (subtle) */
.btn:hover:not(:disabled):not([aria-disabled="true"]) {
    filter: brightness(0.95);
}

/* Button pressed state */
.btn:active:not(:disabled):not([aria-disabled="true"]) {
    transform: translateY(1px);
    box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
}
</style>
