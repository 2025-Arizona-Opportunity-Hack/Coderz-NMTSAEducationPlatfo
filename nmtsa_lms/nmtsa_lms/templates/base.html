<!DOCTYPE html>
<html lang="en" data-theme="light" data-font-size="medium">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="NMTSA Learning Management System - Autism-friendly online learning platform for neurologic music therapy education">

    <title>{% block title %}NMTSA Learning{% endblock %}</title>

    {% load static %}
    <link rel="stylesheet" href="{% static 'css/output.css' %}">

    <!-- Preload critical resources -->
    <link rel="preconnect" href="https://fonts.googleapis.com">

    {% block extra_css %}{% endblock %}
</head>
<body>
    <!-- Skip to main content link for screen readers -->
    <a href="#main-content" class="sr-only focus:not-sr-only focus:absolute focus:top-0 focus:left-0 focus:z-50 focus:p-4 focus:bg-primary focus:text-white">
        Skip to main content
    </a>

    <!-- Navigation Bar -->
    {% block navbar %}
    {% include 'components/navbar.html' %}
    {% endblock %}

    <!-- Main Content -->
    <main id="main-content" class="container" style="margin-top: var(--spacing-xl); margin-bottom: var(--spacing-2xl); padding-top: 80px;">
        <!-- Messages/Alerts -->
        {% if messages %}
        <div style="margin-bottom: var(--spacing-lg);">
            {% for message in messages %}
            <div class="alert alert-{{ message.tags }}" role="alert">
                {{ message }}
            </div>
            {% endfor %}
        </div>
        {% endif %}

        <!-- Page Content -->
        {% block content %}{% endblock %}
    </main>

    <!-- Footer -->
    <footer style="background-color: var(--bg-card); border-top: 2px solid var(--border-color); padding: var(--spacing-xl) 0; margin-top: var(--spacing-2xl);">
        <div class="container">
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: var(--spacing-xl);">
                <div>
                    <h3 style="margin-top: 0;">NMTSA Learning</h3>
                    <p style="color: var(--text-secondary);">
                        Changing lives through innovative music therapy education and professional development.
                    </p>
                </div>

                <div>
                    <h4 style="margin-top: 0;">Quick Links</h4>
                    <ul style="list-style: none; padding: 0;">
                        <li style="margin-bottom: var(--spacing-sm);"><a href="/">Home</a></li>
                        <li style="margin-bottom: var(--spacing-sm);"><a href="/courses/">Browse Courses</a></li>
                        <li style="margin-bottom: var(--spacing-sm);"><a href="/#about">About NMTSA</a></li>
                        <li style="margin-bottom: var(--spacing-sm);"><a href="/contact/">Contact Us</a></li>
                    </ul>
                </div>

                <div>
                    <h4 style="margin-top: 0;">Accessibility</h4>
                    <p style="color: var(--text-secondary); font-size: calc(0.875rem * var(--font-scale));">
                        This platform is designed with autism-friendly accessibility in mind.
                        Use the accessibility controls in the navigation bar to adjust theme and text size to your preference.
                    </p>
                </div>
            </div>

            <div style="margin-top: var(--spacing-xl); padding-top: var(--spacing-lg); border-top: 1px solid var(--border-color); text-align: center; color: var(--text-muted);">
                <p>&copy; 2025 NMTSA. All rights reserved. | <a href="/privacy/">Privacy Policy</a> | <a href="/terms/">Terms of Service</a></p>
            </div>
        </div>
    </footer>

    <!-- Theme Switcher JavaScript -->
    <script>
        // Initialize theme from localStorage or default to 'light'
        function initTheme() {
            const savedTheme = localStorage.getItem('nmtsa-theme') || 'light';
            const savedFontSize = localStorage.getItem('nmtsa-font-size') || 'medium';

            setTheme(savedTheme, false);
            setFontSize(savedFontSize, false);
        }

        // Set theme and save to localStorage
        function setTheme(theme, save = true) {
            document.documentElement.setAttribute('data-theme', theme);

            if (save) {
                localStorage.setItem('nmtsa-theme', theme);
            }

            // Update button states (visual indicator of active theme)
            document.querySelectorAll('.theme-btn').forEach(btn => {
                btn.style.borderColor = 'var(--border-color)';
                btn.style.backgroundColor = 'var(--bg-secondary)';
                btn.style.color = 'var(--text-secondary)';
                btn.style.boxShadow = 'none';
            });

            const activeBtn = document.getElementById('theme-' + theme);
            if (activeBtn) {
                activeBtn.style.borderColor = 'var(--primary)';
                activeBtn.style.backgroundColor = 'var(--primary-light)';
                activeBtn.style.color = 'var(--primary)';
                activeBtn.style.boxShadow = 'var(--shadow-sm)';
            }
        }

        // Set font size and save to localStorage
        function setFontSize(size, save = true) {
            document.documentElement.setAttribute('data-font-size', size);

            if (save) {
                localStorage.setItem('nmtsa-font-size', size);
            }

            // Update button states
            document.querySelectorAll('.font-btn').forEach(btn => {
                btn.style.borderColor = 'var(--border-color)';
                btn.style.backgroundColor = 'var(--bg-secondary)';
                btn.style.color = 'var(--text-secondary)';
                btn.style.boxShadow = 'none';
            });

            const activeBtn = document.getElementById('font-' + size);
            if (activeBtn) {
                activeBtn.style.borderColor = 'var(--primary)';
                activeBtn.style.backgroundColor = 'var(--primary-light)';
                activeBtn.style.color = 'var(--primary)';
                activeBtn.style.boxShadow = 'var(--shadow-sm)';
            }
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', initTheme);
    </script>

    {% block extra_js %}{% endblock %}
</body>
</html>
